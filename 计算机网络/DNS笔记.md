# DNS笔记

1. 前言

   >之前自己也算是系统的看完了计算机网络的书+B站中的一个视频，现在感觉忽然我又忘记了，只知道一些大概的DNS。然后今天想做下笔记。

2. DNS的作用

   >将域名转化为IP地址

3. 为什么机器在处理IP数据报时要使用IP地址位而不会用域名呢？

   >这是因为IP地址的长度是固定的32位（如果是IPV6地址，那就是128位，也是定长的），而域名的长度并不是固定的，机器处理起来比较困难。

4. www.mail.cctv.com

   >com为顶级域名
   >
   >cctv为二级域名
   >
   >mail为三级域名
   >
   >www为四级域名

5. DNS划分的举例

   ![image-20200609162714556](https://i.loli.net/2020/06/09/yvN5MnlOH9G8LaR.png)

6. 域名服务器的分类

   1. 根域名服务器：

      > 根域名服务器是最高层次的域名服务器，也是最重要的域名服务器。所有的根域名服务器都知道所有的顶级域名服务器的域名和IP地址。根域名服务器是最重要的域名服务器，因为不管是哪一个本地域名服务器，若要对互联网上任何一个域名进行解析，只要自己无法解析，就首先要求助于根域名服务器。

   2. 顶级域名服务器：

      > 这些域名服务器负责管理在该顶级域名服务器注册的所有二级域名。当收到DNS查询请求时，就会给出响应的回答（可能是最后的结果，也可能是下一步应该找的域名服务器的IP地址）。

   3. 权限域名服务器：

      > 负责一个区的域名服务器。当一个权限域名服务器还不能给出最后的查询时，就会告诉发出查询请求的DNS客户，下一步应当去找哪一个权限域名服务器。

   4. 本地域名服务器

      >当一台主机发出DNS查询请求时，这个查询请求报文就发送给本地域名服务器。

   5. 主机向本地域名服务器的查询一般都是采用递归查询

   6. 本地域名服务器向根域名服务器的查询通常是采用迭代查询。

   7. ![image-20200609204826535](https://i.loli.net/2020/06/09/M6GDdI8BkYAfjtL.png)

   8. m.xyz.com主机想要知道y.abc.com的IP地址。例如，m.xyz.com打算发送邮件给主机y.abc.com。这是就必须知道主机y.abc.com的IP地址。下面是查询步骤

      1. 主机m.xyz.com先向其本地域名服务器dns.xyz.com进行递归查询。
      2. 本地域名服务器采用迭代查询，它先向一个根域名服务器查询
      3. 根域名服务器告诉本地域名服务器，下一次应查询的顶级域名服务器dns.com的IP地址
      4. 本地域名服务器向顶级域名服务器dns.com进行查询
      5. 顶级域名服务器dns.com告诉本地域名服务器，下一次应查询的权限域名服务器dns.abc.com的IP地址。
      6. 本地域名服务器向权限域名服务器dns.abc.com进行查询
      7. 权限域名服务器dns.abc.com告诉本地域名服务器，所查询的主机的IP地址。
      8. 本地域名服务器最后把查询结构告诉主机m.xyz.com

      这8个步骤总共要使用8个UDP用户数据报的报文。本地域名服务器过三次迭代查询后，从权限域名服务器dns.abc.com得到了主机y.abc.com的IP地址，最后把结果返回给发起查询的主机m.xyz.com。

   9. 为了提高DNS查询效率，并减轻根域名服务器的负荷和减少互联网上的DNS查询文数量，在域名服务器中广泛地使用了高速缓存。如果在不久前已经有用户查询或域名为y.abc.com的IP地址，那么本地域名服务器就不必向根域名服务器重新查询y.abc.com的IP地址，而是直接把告诉缓存中存放的上次查询结果告诉用户，或者本地域名服务器存放着顶级域名dns.com的IP地址，那么本地域名服务器也可以不向根域名服务器进行查询而是直接向com顶级域名服务器发送查询请求报文。这样不仅仅可以大大减轻根域名服务器的符合，而且也能够使互联网上的DNS查询请求和回答保温的数量大为减少。